ggtitle("Histogram of TVs") +
xlab("TVs") +
ylab("Frequency")
library(ggplot2)
library(reader)
data = read.csv("~/stat159/hw/stat159-fall2016-hw02/data/Advertising.csv")
pdf("../images/histogram-tv.png")
hist_TV = ggplot(data = data, aes(data$TV)) +
geom_histogram(aes(fill = ..count..),
binwidth = 20) +
ggtitle("Histogram of TVs") +
xlab("TVs") +
ylab("Frequency")
dev.off()
pdf("../images/histogram-tv.pdf")
hist_TV = ggplot(data = data, aes(data$TV)) +
geom_histogram(aes(fill = ..count..),
binwidth = 20) +
ggtitle("Histogram of TVs") +
xlab("TVs") +
ylab("Frequency")
dev.off()
save(hist_TV, file = "../images/histogram-tv.png")
pdf("../images/histogram-tv.pdf")
hist_TV
dev.off()
png("..images/histogram-tv.png")
hist_TV
dev.off()
png("../images/histogram-tv.png")
hist_TV
dev.off()
save_files = function(x, path, type=pdf()){
type("path")
x
dev.off
}
save_files(hist_TV, ../images/histogram-tv-test.pdf, pdf())
save_files(hist_TV, ../images/histogram-tv-test.pdf, pdf)
save_files = function(x, path, type=pdf(){
type("path")
x
dev.off()
}
save_files = function(x, path, type=pdf){
type("path")
x
dev.off()
}
save_files(hist_TV, ../images/histogram-tv-test.pdf, pdf)
pdf("../images/histogram-sales.pdf")
hist_Sales
dev.off()
png("../images/histogram-sales.png")
hist_Sales
dev.off()
hist_TV = ggplot(data = data, aes(data$TV)) +
geom_histogram(aes(fill = ..count..),
binwidth = 5) +
ggtitle("Histogram of TVs") +
xlab("TVs") +
ylab("Frequency")
pdf("../images/histogram-tv.pdf")
hist_TV
dev.off()
png("../images/histogram-tv.png")
hist_TV
dev.off()
# Save Histograms
pdf("../images/histogram-tv.pdf")
hist_TV
dev.off()
png("../images/histogram-tv.png")
hist_TV
dev.off()
hist_TV = ggplot(data = data, aes(data$TV)) +
geom_histogram(aes(fill = ..count..),
binwidth = 15) +
ggtitle("Histogram of TVs") +
xlab("TVs") +
ylab("Frequency")
pdf("../images/histogram-tv.pdf")
hist_TV
dev.off()
png("../images/histogram-tv.png")
hist_TV
dev.off()
save(reg_TV.Sales, reg_summary, file = "regression.RData")
plot(reg_TV.Sales)
library(ggplot2)
?lm
ggplot(data = data, aes(x = TV, y = Sales)) +
geom_point(aes(color = cyl))
ggplot(data = data, aes(x = TV, y = Sales)) +
geom_point(aes(color = blue))
ggplot(data = data, aes(x = TV, y = Sales)) +
geom_point(aes(color = "blue"))
ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "blue"))
reg_TV.Sales = lm(Sales~TV, data = data)
reg_summary = summary(reg_TV.Sales)
save(reg_TV.Sales, reg_summary, file = "regression.RData")
ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "blue"))
ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point()
plot(data$TV, data$Sales)
data$TV
plot(data$TV, data$Sales)
plot(data$TV, data$Sales)
ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point()
library(stats)
library(ggplot2)
reg_TV.Sales = lm(Sales~TV, data = data)
reg_summary = summary(reg_TV.Sales)
save(reg_TV.Sales, reg_summary, file = "regression.RData")
ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point()
ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "blue"))
ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "blue")) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales")
geom_smooth(model = reg_TV.Sales)
ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "33FFF")) +
geom_smooth(model = reg_TV.Sales)
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales")
ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "33FFF")) +
geom_smooth(model = reg_TV.Sales) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales")
# plot
ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "33FFF")) +
geom_smooth(reg_TV.Sales) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales")
ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "33FFF")) +
geom_smooth(method = reg_TV.Sales) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales")
ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "33FFF")) +
geom_smooth(method = lm) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales")
ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "red")) +
geom_smooth(method = lm) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales")
ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(colour = "red")) +
geom_smooth(method = lm) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales")
ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point() +
geom_smooth(method = lm) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales")
ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = FF9999)) +
geom_smooth(method = lm) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales")
ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "FF9999")) +
geom_smooth(method = lm) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales")
ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "FF9999")) +
geom_smooth(method = lm, aes(color = "black")) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales")
ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "FF9999")) +
guides(fill == FALSE) +
geom_smooth(method = lm, aes(color = "black")) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales")
# plot
ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "FF9999")) +
theme(legend.position = "none") +
geom_smooth(method = lm, aes(color = "black")) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales")
scatterplot = ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "FF9999")) +
theme(legend.position = "none") +
geom_smooth(method = lm, aes(color = "black")) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales")
# Save Plot
pdf("../images/scatterplot-tv-sales.pdf")
scatterplot
dev.off()
png("../images/scatterplot-tv-sales.png")
scatterplot
dev.off()
outfile = "../data/eda-output.txt"
cat("Summary Statistics of TV ads on Sales\n\n", file = outfile)
cat("Minimum:", min, "\n", file = outfile, append = TRUE)
save(reg_TV.Sales, reg_summary, file = "../data/regression.RData")
table_Sales
min_TV = min(data$TV)
min_TV
max_TV = max(data$TV)
mean_TV = mean(data$TV)
median_TV = median(data$TV)
my.summary = function(x, na.rm=TRUE){
result = c(Mean=mean(x, na.rm=na.rm),
SD=sd(x, na.rm=na.rm),
Median=median(x, na.rm=na.rm),
Min=min(x, na.rm=na.rm),
Max=max(x, na.rm=na.rm),
N=length(x))
}
my.summary(data$TV)
print(my.summary(data$TV))
table_TV = as.data.frame(my.summary(data$TV))
table_TV
sapply(data[ ,"TV"], my.summary)
sapply(data[, "TV"], my.summary)
View(sapply(data[, "TV"], my.summary))
sapply(data$TV, my.summary)
my.summary = function(x, na.rm=TRUE){
rbind(Mean = mean(x, na.rm=na.rm),
SD = sd(x, na.rm=na.rm),
Median = median(x, na.rm=na.rm),
Min = min(x, na.rm=na.rm),
Max = max(x, na.rm=na.rm),
N = length(x))
}
my.summary(data$TV)
my.summary = function(x, na.rm=TRUE){
cbind(Mean = mean(x, na.rm=na.rm),
SD = sd(x, na.rm=na.rm),
Median = median(x, na.rm=na.rm),
Min = min(x, na.rm=na.rm),
Max = max(x, na.rm=na.rm),
N = length(x))
}
my.summary(data$TV)
my.summary = function(x, na.rm=TRUE){
as.data.frame(cbind(Mean = mean(x, na.rm=na.rm),
SD = sd(x, na.rm=na.rm),
Median = median(x, na.rm=na.rm),
Min = min(x, na.rm=na.rm),
Max = max(x, na.rm=na.rm),
N = length(x)))
}
my.summary(data$TV)
stats_TV = my.summary(data$TV)
stats_TV
View(stats_TV)
stats_Sales = my.summary(data$Sales)
stats_Sales
sink("../data/eda-output.txt")
stats_TV
stats_Sales
hist_TV
hist_Sales
sink()
?as.data.frame
my.summary = function(x, na.rm=TRUE){
as.data.frame(cbind(Mean = mean(x, na.rm=na.rm),
SD = sd(x, na.rm=na.rm),
Median = median(x, na.rm=na.rm),
Min = min(x, na.rm=na.rm),
Max = max(x, na.rm=na.rm),
N = length(x)),
row.names = NULL)
}
stats_TV = my.summary(data$TV)
stats_TV
stats_Sales = my.summary(data$Sales)
sink("../data/eda-output.txt")
cat("Summary Statistics of TV ads on Sales\n\n")
stats_TV
stats_Sales
sink()
sink("../data/eda-output.txt")
cat("Summary Statistics of TV ads on Sales\n\n")
cat(stats_TV, "\n")
cat(stats_Sales)
sink()
sink("../data/eda-output.txt")
cat("Summary Statistics of TV ads on Sales\n\n")
stats_TV
cat("\n")
stats_Sales
sink()
stats_TV = my.summary(data$TV)
stats_Sales = my.summary(data$Sales)
stats_TV
stats_Sales
my.summary = function(x, na.rm=TRUE){
as.data.frame(cbind(Mean = mean(x, na.rm=na.rm),
SD = sd(x, na.rm=na.rm),
Median = median(x, na.rm=na.rm),
Min = min(x, na.rm=na.rm),
Max = max(x, na.rm=na.rm),
N = length(x)),
row.names = NULL)
}
stats_TV = my.summary(data$TV)
stats_TV
scatterplot
scatterplot = ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "FF9999")) +
theme(legend.position = "none") +
geom_smooth(method = lm, aes(color = "black")) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales") +
geom_errorbar()
scatterplot
scatterplot = ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "FF9999")) +
theme(legend.position = "none") +
geom_smooth(method = lm, aes(color = "black")) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales") +
geom_linerange()
scatterplot
?geom_linerange
?transform
data2 = transform(data, fitted = fitted(reg_TV.Sales))
geom_segment(aes(x = data$TV, y = data$Sales, xend = data$TV, yend = fitted))
# plot
scatterplot = ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "FF9999")) +
theme(legend.position = "none") +
geom_smooth(method = lm, aes(color = "black")) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales") +
geom_segment(aes(x = data$TV, y = data$Sales, xend = data$TV, yend = fitted))
scatterplot
scatterplot = ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "FF9999")) +
theme(legend.position = "none") +
geom_smooth(method = lm, aes(color = "black")) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales") +
geom_segment(aes(x = data$TV, y = data$Sales, xend = data$TV, yend = data2$fitted))
scatterplot
scatterplot = ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "FF9999")) +
theme(legend.position = "none") +
geom_smooth(method = lm, aes(color = "black")) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales") +
geom_segment(aes(x = data$TV, y = data$Sales,
xend = data$TV, yend = data2$fitted,
color = "gray"))
scatterplot
scatterplot = ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "#FF9999")) +
theme(legend.position = "none") +
geom_smooth(method = lm, aes(color = "black")) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales") +
geom_segment(aes(x = data$TV, y = data$Sales,
xend = data$TV, yend = data2$fitted,
color = "gray"))
scatterplot
scatterplot = ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "#FF9999")) +
theme(legend.position = "none") +
geom_smooth(method = lm, aes(color = "#000000")) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales") +
geom_segment(aes(x = data$TV, y = data$Sales,
xend = data$TV, yend = data2$fitted,
color = "gray"))
scatterplot
# plot
scatterplot = ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(color = "blue")) +
theme(legend.position = "none") +
geom_smooth(method = lm, aes(color = "black")) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales") +
geom_segment(aes(x = data$TV, y = data$Sales,
xend = data$TV, yend = data2$fitted,
color = "gray"))
scatterplot
scatterplot = ggplot(data = data, aes(x = data$TV, y = data$Sales, color = "blue")) +
geom_point() +
theme(legend.position = "none") +
geom_smooth(method = lm, aes(color = "black")) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales") +
geom_segment(aes(x = data$TV, y = data$Sales,
xend = data$TV, yend = data2$fitted,
color = "gray"))
scatterplot
# plot
scatterplot = ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(colour="#CC0000") +
theme(legend.position = "none") +
geom_smooth(method = lm, aes(color = "black")) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales") +
geom_segment(aes(x = data$TV, y = data$Sales,
xend = data$TV, yend = data2$fitted,
color = "gray"))
scatterplot
scatterplot = ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(colour="#CC0000")) +
theme(legend.position = "none") +
geom_smooth(method = lm, aes(color = "black")) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales") +
geom_segment(aes(x = data$TV, y = data$Sales,
xend = data$TV, yend = data2$fitted,
color = "gray"))
scatterplot
# plot
scatterplot = ggplot(data = data, aes(x = data$TV, y = data$Sales)) +
geom_point(aes(colour="#CC0000")) +
theme(legend.position = "none") +
geom_smooth(method = lm, aes(colour = "black")) +
ggtitle("Scatterplot of TV Ads and Sales") +
xlab("TV Ads") +
ylab("Sales") +
geom_segment(aes(x = data$TV, y = data$Sales,
xend = data$TV, yend = data2$fitted,
color = "gray"))
scatterplot
pdf("../images/scatterplot-tv-sales.pdf")
scatterplot
dev.off()
png("../images/scatterplot-tv-sales.png")
scatterplot
dev.off()
reg_summary
reg_TV.Sales$coefficients
class(reg_TV.Sales$coefficients)
as.data.frame(reg_TV.Sales$coefficients)
reg_full_summary = summary(reg_TV.Sales)
reg_coef = as.data.frame(reg_TV.Sales$coefficients)
tidy(reg_TV.Sales)
library(broom)
install.packages("broom")
library(broom)
tidy(reg_TV.Sales)
class(tidy(reg_TV.Sales))
data = transform(data, fitted = fitted(reg_TV.Sales))
reg_short_summary = tidy(reg_TV.Sales)
save(reg_TV.Sales, reg_full_summary, reg_short_summary, file = "../data/regression.RData")
data = read.csv("../data/Advertising.csv")
data = read.csv("../data/Advertising.csv")
data = transform(data, fitted = fitted(reg_TV.Sales))
rm(data2)
reg_full_summary
reg_full_summary$r.squared
reg_full_summary$adj.r.squared
reg_full_summary$fstatistic
reg_full_summary$fstatistic[1]
r_squared = reg_full_summary$r.squared
f_stat = as.numeric(reg_full_summary$fstatistic[1])
f_stat
reg_full_summary$residuals
reg_full_summary$sigma
reg_quality = rbind(r_squared, f_stat, rse)
rse = reg_full_summary$sigma
reg_quality = rbind(r_squared, f_stat, rse)
reg_quality
?rbind
colnames(reg_quality) = c("Quality", "Value")
colnames(reg_quality) = c("Value")
reg_quality
reg_short_summary
reg_full_summary
save(reg_TV.Sales, reg_full_summary, reg_short_summary, reg_quality, file = "../data/regression.RData")
rownames(stats_TV) = NULL
stats_TV
